var jsonURL="",altKeyHeight=[900,1036,1036,928,1036],amendChartData=!0,animationTime=500,chartDiameter=120,chartContainerHeights=[180,260,385,260,270],bandHeightMobile=chartDiameter-20,desktopView=!0,firstLoad=!0,keyHeight=[],logHeights=[86,86,86,86,220],mobileBreakPoint=991,rawKey={},tab1Animation=!1,tab3Animation=!1;function activeTabHandler(e){return void 0!==e&&0!=e||(e="tab1"),e}function amendLayoutHandler(){var e=activeTabHandler(checkUrlParameters()),a=returnTabID(e);switch(e){case"tab1":case"tab2":case"tab3":case"tab5":animateToPlace(a),animateGuideImageIn(logHeights[a]);break;case"tab4":animateToPlace(a),animateGuideImageIn(logHeights[a]),animateBestFitLabel(1);break;default:animateToPlace(a),animateGuideImageIn(86)}animateHideDefaultTabKey(a)}function appendURL(e){var a="";checkUrlParameters()&&(a=(a=window.location.href).slice(0,a.indexOf("#"))),window.location=a+"#"+e}function canvasID(e){return e.split(" ").join("-").toLowerCase()}function buildkeyHeightArray(){$.getJSON(jsonURL,(function(e){var a=jQuery.parseJSON(JSON.stringify(e));$.each(a.profiles,(function(e){keyHeight[e]=a.profiles[e].profile_key_height}))}))}function caveatChange(e,a){var t=e[a].profile_caveat;$("#chart-caveat p:first").html(t)}function changeChartsDataBandValue(e){$.each(e.profile_charts,(function(a){$(".chart-canvas:eq("+a+")").attr("data-chart-value",e.profile_charts[a].profile_chart_band)}))}function changeMenuSelect(e){var a=$("select.chartsjs-application-select").val();a?e!=a&&$("select.chartsjs-application-select").val(e):$("select.chartsjs-application-select").val(e)}function changeMenuTop(e){$("ul.nav-list li a").attr("aria-selected","false").parent().removeClass("active"),$("#chartsjs-application-menu a[aria-controls|='"+e+"']").attr("aria-selected","true").parent().addClass("active")}function chartBuild(e,a,t){var n=zeroCheck(t),i=handleChartData(n[0]),r=labelCheck(n[1]),o=n[2],c=document.getElementById(e).getContext("2d");new Chart(c,{type:"doughnut",data:{labels:r,datasets:[{label:a,data:i,backgroundColor:o,borderColor:"#ffffff",borderWidth:1}]},options:{cutoutPercentage:75,legend:{display:!1},elements:{center:{text:a,color:"#333333",fontStyle:"ss_rg",sidePadding:15}},tooltips:{callbacks:{label:function(e,a){return a.labels[e.index]+": "+a.datasets[0].data[e.index]+"%"}}}}})}function chartGuideBuild(e,a){var t=paneKeyMaster(e,a);$("#profile-key").html(t);e.profile_name;$("#chart-guide img").attr("src",e.profile_logo)}function chartLabelBuild(e,a){e.canvas_labels&&$.each(e.profile_charts,(function(a){var t=e.profile_charts[a].profile_chart_band;if(checkIsDesktop())var n="<p class='canvas-label'>"+t+"%</p>";if(checkIsMobile())n="<p class='canvas-label'>"+t+"%</p>";$(".chart-canvas[data-chart-value|="+t+"]").append(n)}))}function chartLabelClear(){$("p.canvas-label").remove()}function checkUrlParameters(){var e=window.location.href.split("#")[1];return!(void 0===e||!checkParamExists(e))&&e}function checkParamExists(e){return!!$("#chartsjs-application-tool-menu a[aria-controls='"+e+"']").length}function checkIsDesktop(){return!windowWidthCheck()}function checkIsMobile(){return!!windowWidthCheck()}function getNumberOfItems(e){return $('.chart-canvas[data-chart-value="'+e+'"]').length}function getNumberOfItemsInRange(e){var a=e[0].bottom,t=e[0].top,n=0;return $(".chart-canvas").each((function(e){var i=$(".chart-canvas:eq("+e+")").attr("data-chart-value");i<=t&&i>=a&&n++})),n}function handleChartData(e){if(amendChartData){for(var a=[],t=0;t<e.length;t++){var n=e[t].toFixed(2);Math.floor(n)==n&&$.isNumeric(n)&&(n=Math.round(n)),a.push(n)}return a}return e}function hasWhiteSpace(e){return e.indexOf(" ")>=0}function heightCheck(){var e=activeTabHandler(checkUrlParameters()),a="",t=$(".chart-canvas-parent-container").height();return checkIsDesktop&&(a="tab3"==e&&212==t?"+=165":"tab1"==e||"undefined"==e?tab3Animation?"fireAmend":"noAmend":"+=120"),a}function keyBasicBuild(e){var a=getNumberOfItems(e),t=activeTabHandler(checkUrlParameters());if(checkIsMobile()){var n="height: "+bandHeightMobile+"px;";0==a&&(a=1);var i="padding-top: "+(bandHeightMobile/2-12)+"px;"}if(checkIsDesktop())n="",i="";if("tab1"==t)var r="band hidden";else r="band";return'<div class="'+r+'" style="'+n+'"><p class="band-label" style="'+i+'">'+e+"</p></div>"}function keyBuildStyle1(e,a){changeChartsDataBandValue(e);var t="";return $.each(e.profile_bands,(function(a){$.each(e.profile_bands[a],(function(n){t+=keyBasicBuild(e.profile_bands[a][n])}))})),t}function keyBuildTab4(e,a){changeChartsDataBandValue(e);var t="";return $.each(e.profile_bands,(function(a){$.each(e.profile_bands[a],(function(n){var i=e.profile_bands[a][n][0].top,r=e.profile_bands[a][n][0].bottom,o=getNumberOfItemsInRange(e.profile_bands[a][n]);if(checkIsMobile()){var c=r,s=i,l="height: "+(chartDiameter+10)+"px;";0==o&&(o=1);var u="padding-top: "+((chartDiameter+10)/2-18)+"px;"}if(checkIsDesktop())c=r,s=i,l="width: 14.285%;",u="";t+='<div class="band" style="'+l+'"><p class="band-label" style="'+u+'">'+c+" -  "+s+"</p></div>"}))})),t}function keyBuildStyleDefault(e,a){changeChartsDataBandValue(e);var t="";return $.each(e.profile_bands,(function(a){$.each(e.profile_bands[a],(function(n){t+=keyBasicBuild(e.profile_bands[a][n])}))})),t}function keyNameColurLookup(e){var a=e.replace("chart_","");a=(a=a.substr(0,1).toUpperCase()+a.substr(1)).split("_").join(" ");var t="";return $.each(rawKey,(function(e,n){e==a&&(t=n)})),[a,t]}function labelCheck(e){for(var a=[],t=0;t<e.length;t++)a.push(e[t].split("_").join(" "));return a}function paneDataMaster(e,a){var t=e[a].profile_id,n=e[a].profile_charts;$("#profile-name").html(e[a].profile_name+" profile chart"),populateCharts(n,t)}function paneKeyMaster(e,a){chartLabelClear(),checkUrlParameters()&&$("#profile-key").removeClass("hidden");var t="";switch(a){case 0:default:t=keyBuildStyleDefault(e,a),chartLabelBuild(e,a);break;case 1:case 2:case 4:t=keyBuildStyle1(e,a),chartLabelBuild(e,a);break;case 3:t=keyBuildTab4(e,a),chartLabelBuild(e,a)}return $("#"+e.profile_id+"-profile-key").html(t),t}function populateCharts(e,a){$.each(e,(function(a){var t=e[a].profile_chart_composition,n=e[a].profile_chart_name,i=e[a].profile_chart_band;$.each(t,(function(e){chartBuild(canvasID(n),n,t[e]),$("#"+canvasID(n)).parent().attr("data-chart-value",i)}))}))}function profileGuideLoad(e){$.getJSON(jsonURL,(function(a){var t=jQuery.parseJSON(JSON.stringify(a)),n=returnTabID(e);firstLoad&&paneDataMaster(t.profiles,n),caveatChange(t.profiles,n),chartGuideBuild(t.profiles[n],n)}))}function profileTransitionDesktop(e){event.preventDefault(),animationReset(returnActiveMenu()),transitionProfile(e),amendLayoutHandler(),profileGuideLoad(e),animationHandler()}function profileTransitionMobile(e){event.preventDefault(),animationReset(returnActiveMenu()),transitionProfile(e),amendLayoutHandler(),profileGuideLoad(e),resetContainerHeight(returnTabID(e)),animationHandler()}function removeStyleContent(){$(".chart-canvas, .chart-guide, .chart-canvas-container, .chart-group").removeAttr("style"),$(".chart-canvas:eq(6)").removeAttr("style")}function removeParentStyle(){$(".chart-canvas-parent-container, .profile-key-container").attr("style",""),$(".chart-canvas-parent-container, .profile-key-container").removeAttr("style")}function resetContainerHeight(e){if(checkIsMobile()){var a=0;a=void 0===keyHeight[e]?setKeyHeightFirstLoad(e):keyHeight[e],$(".chart-canvas-container, .chart-group").animate({height:a},{duration:animationTime,queue:!1})}}function returnTabID(e){return e.substr(3)-1}function returnActiveMenu(){return $(".tab.active a").attr("aria-controls")}function setChartColours(){$.getJSON(jsonURL,(function(e){var a=jQuery.parseJSON(JSON.stringify(e));$.each(a.chartKey,(function(e){$.each(a.chartKey[e],(function(t){rawKey[t]=a.chartKey[e][t]}))}))}))}function setKeyHeightFirstLoad(e){return altKeyHeight[e]}function transitionProfile(e){e!=returnActiveMenu()&&($("#chart-guide").fadeOut(0),$("#profile-key").fadeOut(0),changeMenuSelect(e),changeMenuTop(e),appendURL(e),$("#chart-guide").fadeIn(animationTime),$("#profile-key").fadeIn(animationTime))}function windowWidthCheck(){if($(window).width()<=mobileBreakPoint)return!0}function zeroCheck(e){for(var a=Object.keys(e),t=Object.values(e),n=[[],[],[]],i=0;i<a.length;i++)if(0!==t[i]){var r=keyNameColurLookup(a[i]);n[0].push(t[i]),n[1].push(r[0]),n[2].push(r[1])}return n}function animateChartContainerHeight(e){if(checkIsDesktop()){var a=chartContainerHeights[e];$(".chart-canvas-parent-container").animate({height:a},{duration:animationTime,queue:!1})}}function animateLeftFinemetrica(){var e=activeTabHandler(checkUrlParameters());checkIsMobile()&&("tab4"==e?$(".chart-group").animate({right:70},{duration:animationTime,queue:!1}):$(".chart-group").animate({right:0},{duration:animationTime,queue:!1}))}function animateHideDefaultTabKey(e){if(checkIsDesktop()){if(0==e&&0==tab1Animation){tab1Animation=!0;heightCheck();$(".profile-key-container").animate({height:0,paddingTop:0},{duration:animationTime,queue:!1}),$(".best-fit.hidden-sm.hidden-xs").animate({height:0},{duration:animationTime,queue:!1}),$(".chart-canvas-parent-container").animate({height:chartContainerHeights[0]},{duration:animationTime,queue:!1})}1==tab1Animation&&(tab1Animation=!1)}}function animateToPlace(e){"tab4"!=activeTabHandler(checkUrlParameters())&&animateBestFitLabel(0),$.getJSON(jsonURL,(function(a){var t=jQuery.parseJSON(JSON.stringify(a));$.each(t.profiles[e].profile_charts,(function(a){if(checkIsDesktop()){var n=t.profiles[e].profile_charts[a].profile_chart_position_horizontal;n+="%"}else n=t.profiles[e].profile_charts[a].profile_chart_position;var i=".chart-canvas:eq("+a+")";checkIsDesktop()?$(i).animate({right:n},{duration:animationTime,queue:!1}):($(i).animate({top:n},{duration:animationTime,queue:!1}),animateLeftFinemetrica())}))}))}function animateTab3(){if(checkIsDesktop()){$(".chart-canvas-parent-container").animate({top:"+=120",height:391},{duration:animationTime,queue:!1}),$(".chart-canvas-container").animate({backgroundPositionY:"+=118"},{duration:animationTime,queue:!1}),$(".profile-key-container, .best-fit, .chart-canvas:lt(6)").animate({top:"+=120"},{duration:animationTime,queue:!1}),$(".chart-canvas:eq(6)").animate({top:0},{duration:animationTime,queue:!1})}checkIsMobile()&&($(".chart-canvas-parent-container, .profile-key-container").attr("style",""),$(".chart-canvas:eq(6)").animate({right:120},{duration:animationTime,queue:!1}))}function reverseAnimateTab3(){checkIsDesktop()&&($(".chart-canvas-parent-container").animate({top:"-=120"},{duration:animationTime,queue:!1}),$(".chart-canvas-container").animate({backgroundPositionY:"-=118"},{duration:animationTime,queue:!1})),checkIsMobile()&&$(".chart-canvas:eq(6)").animate({right:0},{duration:animationTime,queue:!1})}function animateBestFitLabel(e){$(".best-fit p").animate({opacity:e},{duration:animationTime,queue:!1})}function animateGuideImageIn(e){checkIsDesktop()&&$(".chart-guide").animate({height:e},{duration:animationTime,queue:!1})}function animationHandler(){var e=activeTabHandler(checkUrlParameters());"tab3"==e&&(tab3Animation=!0,animateTab3()),"tab3"!=e&&1==tab3Animation&&(tab3Animation=!1,reverseAnimateTab3())}function animationReset(e){"tab3"==e?checkIsDesktop()&&($(".chart-canvas-parent-container").animate({top:"-=120",height:"-=120"},{duration:animationTime,queue:!1}),$(".profile-key-container, .best-fit").animate({top:"-=120"},{duration:animationTime,queue:!1}),$(".chart-canvas").animate({top:0},{duration:animationTime,queue:!1})):"tab4"==e&&animateBestFitLabel(0)}Chart.defaults.global.tooltips.enabled=!1,$(document).ready((function(){$(".loadingContainer").show(),$("#chartsjs-application").hide(),$("#chartsjs-application-menu").hide(),setChartColours(),buildkeyHeightArray();var e=activeTabHandler(checkUrlParameters());changeMenuSelect(e),changeMenuTop(e),profileGuideLoad(e),checkIsMobile()&&(desktopView=!1,resetContainerHeight(returnTabID(e))),amendLayoutHandler(),$(".loadingContainer").hide(),$("#chartsjs-application-menu").show(),$("#chartsjs-application").show(),animationHandler()})),$("ul.nav-list li a").click((function(e){if(checkIsDesktop()){var a=this.getAttribute("aria-controls");returnActiveMenu()!=a&&(firstLoad=!1,profileTransitionDesktop(a),animateChartContainerHeight(returnTabID(a)))}})),$("select.chartsjs-application-select").change((function(e){if(checkIsMobile()){var a=this.value;returnActiveMenu()!=a&&(firstLoad=!1,profileTransitionMobile(a))}})),$(window).on("resize",(function(){var e=activeTabHandler(checkUrlParameters());windowWidthCheck()&&desktopView&&(firstLoad=!1,desktopView=!1,removeStyleContent(),removeParentStyle(),profileTransitionMobile(e)),windowWidthCheck()||desktopView||(firstLoad=!1,desktopView=!0,removeStyleContent(),removeParentStyle(),profileTransitionDesktop(e),animateChartContainerHeight(returnTabID(navPane)))})),Chart.pluginService.register({beforeDraw:function(e){if(e.config.options.elements.center){var a=e.chart.ctx,t=e.config.options.elements.center,n=t.fontStyle||"Arial",i=t.text,r=t.color||"#000000",o=(t.sidePadding||20)/100*(2*e.innerRadius);a.font="30px "+n;a.measureText(i).width,e.innerRadius;a.textAlign="center",a.textBaseline="middle";var c=e.chartArea.left+e.chartArea.right,s=e.chartArea.top+e.chartArea.bottom;if(a.font="16px "+n,a.beginPath(),a.arc(c/2,s/2,59,0,2*Math.PI),a.fillStyle="#ffffff",a.fill(),a.fillStyle=r,hasWhiteSpace(i))for(var l=i.split(" "),u=c/2,h=s/2-6,f=0;f<l.length;f++)a.fillText(l[f],u,h+16*f);else{l=i,u=c/2,h=s/2;a.fillText(l,u,h)}}}});